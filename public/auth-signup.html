<!DOCTYPE html>
<html lang="en">

<head>
    <title>Sociolitic</title>
    <!-- HTML5 Shim and Respond.js IE10 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 10]>
		<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
		<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
		<![endif]-->
    <!-- Meta -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="description" content="Datta Able Bootstrap admin template made using Bootstrap 4 and it has huge amount of ready made feature, UI components, pages which completely fulfills any dashboard needs." />
    <meta name="keywords" content="admin templates, bootstrap admin templates, bootstrap 4, dashboard, dashboard templets, sass admin templets, html admin templates, responsive, bootstrap admin templates free download,premium bootstrap admin templates, datta able, datta able bootstrap admin template, free admin theme, free dashboard template"/>
    <meta name="author" content="CodedThemes"/>
    <script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.4.2/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-analytics.js"></script>
    
    <script>
      var firebaseConfig = {
        apiKey: "AIzaSyDrqOimL_5FP7CnyT0BKpAbPVI471y1QqM",
        authDomain: "sociolitic.firebaseapp.com",
        projectId: "sociolitic",
        storageBucket: "sociolitic.appspot.com",
        messagingSenderId: "1075477400639",
        appId: "1:1075477400639:web:d9fd5e9024dc03759ffc8a",
        measurementId: "G-VYNRYTD9W3"
      };
      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      firebase.analytics();
    </script>
      <link rel="icon" href="assets/images/favicon.png" type="image/png">

    <!-- fontawesome icon -->
    <link rel="stylesheet" href="assets/fonts/fontawesome/css/fontawesome-all.min.css">
    <!-- animation css -->
    <link rel="stylesheet" href="assets/plugins/animation/css/animate.min.css">
    <!-- vendor css -->
    <link rel="stylesheet" href="assets/css/style.css">
    <style>
        .google-button {
            height: 40px;
            border-width: 0;
            background: white;
            color: #737373;
            border-radius: 5px;
            white-space: nowrap;
            box-shadow: 1px 1px 0px 1px rgba(0, 0, 0, 0.05);
            transition-property: background-color, box-shadow;
            transition-duration: 150ms;
            transition-timing-function: ease-in-out;
            padding: 0;
            }
            .google-button:focus, .google-button:hover {
            box-shadow: 1px 4px 5px 1px rgba(0, 0, 0, 0.1);
            }
            .google-button:active {
            background-color: #e5e5e5;
            box-shadow: none;
            transition-duration: 10ms;
            }

            .google-button__icon {
            display: inline-block;
            vertical-align: middle;
            margin: 8px 0 8px 8px;
            width: 18px;
            height: 18px;
            box-sizing: border-box;
            }

            .google-button__icon--plus {
            width: 27px;
            }

            .google-button__text {
            display: inline-block;
            vertical-align: middle;
            padding: 0 24px;
            font-size: 14px;
            font-weight: bold;
            font-family: "Roboto", arial, sans-serif;
            }

            html, body {
            height: 100%;
            }

            body {
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            }

            button ~ button {
            margin-left: 20px;
            }
    </style>

</head>

<body>
    <div class="auth-wrapper">
        <div class="auth-content">
            <div class="auth-bg">
                <span class="r"></span>
                <span class="r s"></span>
                <span class="r s"></span>
                <span class="r"></span>
            </div>
            <div class="card">
                <div class="card-body text-center">
                    <div class="mb-4">
                        <i class="feather icon-user-plus auth-icon"></i>
                    </div>
                    <button type="button" class="google-button gsign">
                        <span class="google-button__icon">
                          <svg viewBox="0 0 366 372" xmlns="http://www.w3.org/2000/svg"><path d="M125.9 10.2c40.2-13.9 85.3-13.6 125.3 1.1 22.2 8.2 42.5 21 59.9 37.1-5.8 6.3-12.1 12.2-18.1 18.3l-34.2 34.2c-11.3-10.8-25.1-19-40.1-23.6-17.6-5.3-36.6-6.1-54.6-2.2-21 4.5-40.5 15.5-55.6 30.9-12.2 12.3-21.4 27.5-27 43.9-20.3-15.8-40.6-31.5-61-47.3 21.5-43 60.1-76.9 105.4-92.4z" id="Shape" fill="#EA4335"/><path d="M20.6 102.4c20.3 15.8 40.6 31.5 61 47.3-8 23.3-8 49.2 0 72.4-20.3 15.8-40.6 31.6-60.9 47.3C1.9 232.7-3.8 189.6 4.4 149.2c3.3-16.2 8.7-32 16.2-46.8z" id="Shape" fill="#FBBC05"/><path d="M361.7 151.1c5.8 32.7 4.5 66.8-4.7 98.8-8.5 29.3-24.6 56.5-47.1 77.2l-59.1-45.9c19.5-13.1 33.3-34.3 37.2-57.5H186.6c.1-24.2.1-48.4.1-72.6h175z" id="Shape" fill="#4285F4"/><path d="M81.4 222.2c7.8 22.9 22.8 43.2 42.6 57.1 12.4 8.7 26.6 14.9 41.4 17.9 14.6 3 29.7 2.6 44.4.1 14.6-2.6 28.7-7.9 41-16.2l59.1 45.9c-21.3 19.7-48 33.1-76.2 39.6-31.2 7.1-64.2 7.3-95.2-1-24.6-6.5-47.7-18.2-67.6-34.1-20.9-16.6-38.3-38-50.4-62 20.3-15.7 40.6-31.5 60.9-47.3z" fill="#34A853"/></svg>
                        </span>
                        <span class="google-button__text">Sign in with Google</span>
                      </button>                      
                </div>
            </div>
        </div>
    </div>

    <!-- Required Js -->
<script src="assets/js/vendor-all.min.js"></script>
<script src="assets/plugins/bootstrap/js/bootstrap.min.js"></script>

</body>

<script>
    var Guser;
    var signedIn=false;

    var auth = firebase.auth()
    var provider = new firebase.auth.GoogleAuthProvider();

    document.querySelector('.gsign').addEventListener('click',()=>{
            auth.signInWithPopup(provider).then((result) => {
                var credential = result.credential;
                var token = credential.accessToken;
                Guser=result.user
                console.log(Guser);
                sendAuth(Guser)
            },(e)=>{
                console.log("159",e);
            }).catch((error) => {
                console.log(error);
            })
    })
    auth.onAuthStateChanged(user => {
        if(user){
            Guser=user
            signedIn=true
            console.log("Signed in");
            // window.location.replace("http://sociolitic-env.eba-5muchqmr.ap-south-1.elasticbeanstalk.com")
        }else{
            signedIn=false
            console.log("Signed Out");
        }
    })

    function sendAuth(data,callback=()=>{console.log(null)}){
        var myHeaders = new Headers();
        myHeaders.append("Content-Type", "application/json");

        var raw = JSON.stringify({
        "user": {
            "userId": data.za,
            "name": data.displayName,
            "email": data.email,
            "photo": data.photoURL
        }
        });

        var requestOptions = {
            method: 'POST',
            headers: myHeaders,
            body: raw,
            redirect: 'follow'
        };

        fetch("http://sociolitic-env.eba-5muchqmr.ap-south-1.elasticbeanstalk.com/auth/verify", requestOptions)
            .then(response => response.text())
            .then(result => postLogin(JSON.parse(result)))
            .catch(error => console.log('error', error));
        }
    function postLogin(result){
        console.log(result.token);
        setCookie("SocioliticId",result.token,9999)
        if(result.stage == 1){
            window.location.replace("http://sociolitic-env.eba-5muchqmr.ap-south-1.elasticbeanstalk.com/selectBrand.html")
        }else{
            window.location.replace("http://sociolitic-env.eba-5muchqmr.ap-south-1.elasticbeanstalk.com")
        }
    }
    function deleteCookie(name) {
        document.cookie = name +'=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';
    }
    function setCookie(name,value,days) {
        var expires = "";
        if (days) {
            var date = new Date();
            date.setTime(date.getTime() + (days*24*60*60*1000));
            expires = "; expires=" + date.toUTCString();
        }
        document.cookie = name + "=" + (value || "")  + expires + "; path=/";
    }

    const getCookieValue = (name) => (
    document.cookie.match('(^|;)\\s*' + name + '\\s*=\\s*([^;]+)')?.pop() || ''
    )
</script>

</html>
